!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).BloggerJS=t()}(this,(function(){"use strict";const e=/s\d{2}(-w\d{3}-h\d{3})?-c/;function t(e){for(const t of e)if("alternate"===t.rel)return t.href}function a(e){const t=null==e?0:e.length;if(!t)return[];let a=-1;const n=t-1,r=function(e,t){let a=-1;const n=e.length;for(t||(t=new Array(n));++a<n;)t[a]=e[a];return t}(e);for(;++a<t;){const e=a+Math.floor(Math.random()*(n-a+1)),t=r[e];r[e]=r[a],r[a]=t}return r}function n(e,t){const a=new Date(e),n=a.getDate();return`${a.getMonth()+1}/${n}/${a.getFullYear()}`}function r(e){return e.replace(/<[^>]*>?/g,"")}function l(e){if(!e)return!1;const t=e.querySelector("[data-bjs=template]");if(!t)return!1;t.removeAttribute("data-bjs");const a=t.outerHTML;return t.remove(),a.replace(/data-src/g,"src")}function s(e,t){return e.replace(/\{\{(.*?)\}\}/g,((e,a)=>t[a]))}function i({dataset:e={}}){const t={};return Object.keys(e).forEach((a=>{var n;t[a]="true"===(n=e[a])||"false"!==n&&(Number(n).toString()===n?Number(n):"null"===n||""===n?null:n)})),t}function o(e){const t=document.createElement("script");t.src=e,document.body.appendChild(t).parentNode.removeChild(t)}const c={small:"s80-c",medium:"s300",large:"s500",max:"s800"},u={small:"default",medium:"mqdefault",large:"hqdefault",max:"maxresdefault"},m={homepage:window.location.origin+"/",category:null,locale:"es-ES",snippet:100,format:{month:"numeric",day:"2-digit",year:"numeric"},image:"",imageSize:"s300",avatarImage:"https://www.gravatar.com/avatar/?d=mm",avatarSize:"s80",authorName:"Unknown",authorUrl:"",labels:{}};function g(e){return null!=e&&"string"==typeof e&&e.includes("img.youtube.com")}function d(t,a){return g(t)?t.replace("default",u[a]||a):t.replace(e,c[a]||a)}function p(e,t){return(null==e?0:e.length)?(e=e?.map((e=>`<a class='${t.prefixClass+e.term}' href='${t.origin}search/label/${e.term}'>${t.before+e.term+t.after}</a>`))?.join(""),`<div class='${t.containerClass}'>${e}</div>`):[]}function f(e,a){const[l]=e.author,s=e.content?e.content.$t:e.summary.$t,i={...m,...a},o=e.id.$t.split(".post-"),c=o[1],u=o[0].split(":blog-")[1],f=e.media$thumbnail?e.media$thumbnail.url:function(e){const t=document.createElement("div");t.innerHTML=e;const a=t.querySelector("img");return a?a.src:""}(s)||i.image,b=l.gd$image.src.includes("g/blank.gif")||l.gd$image.src.includes("g/b16-rounded.gif")?i.avatarImage:l.gd$image.src,h=i.homepage,$=i.labels.length||10,y=null!==e.category&&e.category,x=y?.filter((e=>!e.term.includes(i.labels.without||"undefined_terms")))?.filter((e=>!(i.labels.remove||[]).includes(e.term))).slice(0,$),v=e.category?.filter((e=>e.term.includes(i.labels.terms||""))).slice(0,$),C=e.category?.filter((e=>(i.labels.filter||[]).includes(e.term))).slice(0,$),P={origin:h,prefixClass:i.labels.prefixClass||"label-",containerClass:i.labels.containerClass||"labels",before:i.labels.before||"",after:i.labels.after||""};return{blog_id:u,post_id:c,author_name:"Unknown"!==l.name.$t?l.name.$t:i.authorName,author_url:l.uri?l.uri.$t:i.authorUrl,author_image:b.replace(/s\B\d{2,4}/,i.avatarSize),author_email:l.email?l.email.$t:"#noEmail",img:d(f,g(f)?i.ytThumbnail:i.imageSize),img_max:d(f,"max"),img_large:d(f,"large"),img_medium:d(f,"medium"),img_small:d(f,"small"),time:n(e.published.$t),snippet:(T=r(s),w=i.snippet,T.length>w?`${T.substring(0,w)}...`:T),labels:null==x?[]:x?.map((e=>e.term)),labels_links:p(x,P),labels_filter:p(C,P),labels_terms:p(v,P),content:r(s),url:t(e.link),published:new Date(e.published.$t).getTime(),title:e.title.$t,update:new Date(e.updated.$t).getTime(),category:i.category,thr:e.thr$total?e.thr$total.$t:"0"};var T,w}function b(){const e=new URLSearchParams(window.location.search);let t=e.get("page");var a;return(null===t||(a=t,Number(a).toString()!==a)||Number(t)<1)&&(t="1"),{page:Number(t),results:e.get("max-results"),label:e.get("label"),view:e.get("view")}}const h={},$=(e,t,a)=>{const{homepage:n,category:r}=t,l=n,i=t.category.replace(/[^A-Z0-9]/gi,"")+a;h[i]=a=>{let n="";a.feed.entry?a.feed.entry.forEach((e=>{const a=f(e,t);n+=s(t.template,a)})):n+=t.empty,e.innerHTML=n,e.classList.add("is-loaded")},o(`${l}feeds/posts/default?alt=json-in-script&callback=BloggerJS.sections.${i}&max-results=${t.maxResults}&category=${r}`)},y={observer:!0,maxResults:6,rootMargin:"200px",template:'<div class="bjs-article">\n  <img src="{{img}}"/>\n  <a href="{{url}}">{{title}}</a>\n</div>',empty:"<p>No se ha encontrado entradas</p>"};const x={},v={maxResults:6,template:'<div class="bjs-comments">\n  <img src="{{author_image}}"/>\n  <a href="{{url}}">{{author_name}}</a>\n  <p>{{snippet}}</p>\n</div>',empty:"<p>Sin comentarios</p>"};let C={id:"",length:7,maxResults:8,tags:[],random:!0,template:'<div class="bjs-article">\n  <img src="{{img}}"/>\n  <a href="{{url}}">{{title}}</a>\n</div>'};const P=document.querySelector("[data-bjs=related]");function T({number:e,label:t,perPage:a}){let n=`/search?page=${e}`;const r={...b()};return t&&(n+=`&label=${t}`),r.view&&(n+=`&view=${r.view}`),n+=`&max-results=${r.results??a}`,n}function w({active:e,url:t,title:a,className:n=""}){const r=document.createElement("li"),l=document.createElement("a");return l.href=t,l.innerHTML=a,l.className=n,e&&r.classList.add("is-active"),r.appendChild(l),r}function M({className:e}){const t=document.createElement("li"),a=document.createElement("span");return a.textContent="...",a.className=e,t.appendChild(a),t}function N({homepage:e,firstPage:t,perPage:a,label:n,active:r,className:l}){return w({url:t?e:T({number:"1",label:n,perPage:a}),title:"1",active:r,className:l})}function S({container:e,page:t,results:a,perPage:n,length:r,total:l,label:s,prevText:i,nextText:o,lastPageText:c,firstPage:u,homepage:m,numberClass:g,nextPageClass:d,prevPageClass:p,lastPageClass:f,firstPageClass:b,dotsPageClass:h,firstPageVisible:$,lastPageVisible:y}){const x=document.createDocumentFragment(),v=Math.ceil(l/(a??n)),C=function(e,t,a){const n=[];e>a&&(e=a);let r=1,l=a||1;a>=t&&(l=Math.min(Math.max(e+Math.ceil(t/2)-1,t),a),r=l-t+1);for(let e=r;e<=l;e++)n.push(e);return n}(t,r,v);if(t-1>0){const e=w({url:u&&t-1==1?m:T({number:t-1,label:s,perPage:n}),title:i,className:p});x.appendChild(e)}if($&&!C.includes(1)){const e=N({firstPage:u,homepage:m,label:s,className:b,perPage:n}),t=M({className:h});x.appendChild(e),x.appendChild(t)}if(C.forEach((e=>{let a=null;a=1===e?N({firstPage:u,homepage:m,label:s,active:e===t,className:g,perPage:n}):w({url:T({number:e,label:s,perPage:n}),title:e,active:e===t,className:g}),x.appendChild(a)})),y&&!C.includes(v)){const e=w({url:T({number:v,label:s,perPage:n}),title:c||v,className:f}),t=M({className:h});x.appendChild(t),x.appendChild(e)}if(t+1<=v){const e=w({url:T({number:t+1,label:s,perPage:n}),title:o,className:d});x.appendChild(e)}e.innerHTML="",e.appendChild(x)}let j={firstPage:!1,perPage:7,length:5,label:null,prevText:"Anterior",nextText:"Siguiente",lastPageText:null,ytThumbnail:"mqdefault",template:'<div><img src="{{img}}"/><a href="{{url}}">{{title}}</a></div>',empty:"<p>No se ha encontrado entradas</p>",numberClass:"bjs-number",nextPageClass:"bjs-next-page",prevPageClass:"bjs-prev-page",firstPageClass:"bjs-first-page",lastPageClass:"bjs-last-page",dotsPageClass:"bjs-dots",firstPageVisible:!0,lastPageVisible:!0,infinite:!1,withButton:!1,buttonClass:"bjs-button-show-more",buttonText:"Cargar mas",buttonTextLoading:"Cargando",rootMargin:"100px"};function E({homepage:e,label:t,perPage:a,page:n}){o(`${`${e}feeds/posts/default${t?`/-/${t}`:""}?alt=json-in-script&callback=BloggerJS.entry&max-results=${a}`}&start-index=${(n-1)*a+1}`)}const L=document.querySelector("[data-bjs=entry]"),_=document.querySelector("[data-bjs=pagination]");let k,H=1,B=!1;function q(e){L.innerHTML+=e}var R={sections:h,comments:x,related:function(e){if(!e.feed.entry)return;let t="",n=e.feed.entry.filter((e=>function(e){return e.id.$t.split(".post-")[1]}(e)!==C.id));C.random&&(n=a(n));const r=n.length<=C.length?n.length:C.length;Array.from({length:r}).forEach(((e,a)=>{t+=s(C.template,f(n[a],C))})),P.innerHTML=t},entry:function(e){if(!e.feed.entry)return L.innerHTML="",q(j.empty),void(j.infinite&&_.remove());if(j.infinite){const{button:t,container:a}=k;B=!1,function({data:e,options:t,page:a,container:n}){t.firstPage||1!==a||(n.innerHTML=""),e.forEach((e=>{t.firstPage&&1===a||(n.innerHTML+=s(t.template,f(e,t)))}))}({button:t,container:a,page:H,data:e.feed.entry,options:j}),j.withButton&&(t.textContent=j.buttonText);const n=Number(e.feed.openSearch$totalResults.$t),r=Math.ceil(n/(j.results??j.perPage));return void(H>=r&&_.remove())}const t=function({options:e,data:t,container:a}){let n="";return t.feed.entry.forEach((t=>{n+=s(e.template,f(t,e))})),S({...e,total:Number(t.feed.openSearch$totalResults.$t),container:a}),n}({options:j,data:e,container:_});L&&(L.innerHTML="",q(t))},initComments:function(e={}){Array.from(document.querySelectorAll("[data-bjs=comments]")).forEach(((t,a)=>{const n={...v,...e,...i(t)},r=l(t);r&&(n.template=r),((e,t,a)=>{const n="comments"+a;x[n]=a=>{let n="";a.feed.entry?a.feed.entry.forEach((e=>{const a=f(e,t);n+=s(t.template,a)})):n+=t.empty,e.innerHTML=n},o(`${t.homepage}feeds/comments/default?alt=json-in-script&callback=BloggerJS.comments.${n}&max-results=${t.maxResults}`)})(t,n,a)}))},initRelated:function(e={}){if(!P)return;C={...C,...e,...i(P)};const t=l(P);t&&(C.template=t);const a=("string"==typeof C.tags?JSON.parse(C.tags):C.tags).map((e=>`label:"${e}"`)).join("|");o(`${C.homepage}feeds/posts/default?alt=json-in-script&callback=BloggerJS.related&max-results=${C.maxResults}&q=${a}`)},initEntry:function(e={}){j={...j,...b(),...e,...i(L||!1),...i(_||!1)};const t=l(L);t&&(j.template=t);const{firstPage:a,homepage:n,page:r,label:s,withButton:c,buttonClass:u,buttonText:m,rootMargin:g}=j,d=j.results??j.perPage,p=`${n}feeds/posts/default${s?`/-/${s}`:""}?alt=json-in-script&callback=BloggerJS.entry&max-results=${d}`;if(j.infinite){if(!L||!_)return;o(`${a?p.replace(/max-results=(.[0-9]*)/,"max-results=1"):p}&start-index=1`),k=function({container:e,pagination:t,withButton:a=!1,buttonClass:n,buttonText:r,onClick:l=(()=>{}),onVisible:s=(()=>{}),rootMargin:i="100px"}){let o=null;if(a)o=document.createElement("button"),o.className=n,o.textContent=r,o.addEventListener("click",(()=>{l({button:o,container:e})})),t.innerHTML="",t.appendChild(o);else{const e=new IntersectionObserver((e=>{e.forEach((e=>{e.isIntersecting&&s()}))}),{rootMargin:i});e.observe(t)}return{container:e,button:o}}({buttonClass:u,buttonText:m,rootMargin:g,withButton:c,container:L,pagination:_,onClick({button:e}){B||(e.textContent=j.buttonTextLoading,B=!0,H++,E({label:s,perPage:d,homepage:n,page:H}))},onVisible(){H++,E({label:s,perPage:d,homepage:n,page:H})}})}else{o(`${p}&start-index=${(r-1)*d+1}`)}},initSection:function(e={}){Array.from(document.querySelectorAll("[data-bjs=section]")).forEach(((t,a)=>{const n={...y,...e,...i(t)},r=l(t);if(r&&(n.template=r),!0===n.observer){const e=new IntersectionObserver((r=>{r.forEach((r=>{r.isIntersecting&&($(t,n,a),e.unobserve(r.target))}))}),{rootMargin:n.rootMargin});e.observe(t)}else $(t,n,a)}))}};return R}));